<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../Compiled/corona.min.css">
    <title>Corona Tracker - Epic WebDev</title>
</head>
<body>
    <div id="loader"></div>
    <h1 id="headline">
        Corona Virus Tracker
        <span class="subtitle">
            <a style="
                color: #000;
                text-decoration: none;
            " href="https://github.com/Epiclygend" target="_blank">Epic WebDev</a>
            (<a href="https://www.instagram.com/alwan.nuha/" target="_blank">@alwan.nuha</a>)
        </span>
    </h1>
    <div class="card data">
        <h2>Total Kasus</h2>
        <span id="cases"></span>
    </div>
    <div class="card data">
        <h2>Kasus yang berlangsung</h2>
        <span id="active"></span>
    </div>
    <div class="card data">
        <h2>Total Sembuh</h2>
        <span id="recovered"></span>
    </div>
    <div class="card data">
        <h2>Kasus per hari</h2>
        <span id="perday"></span>
    </div>
    <div class="card data">
        <h2>Total meninggal</h2>
        <span id="death"></span>
    </div>
    <div class="card data">
        <h2>Region</h2>
        <span id="region"></span>
    </div>
    <span>source: <a href="" id="data-source" target="_blank"></a></span>
</body>
<script src="../lib/anime.min.js"></script>
<script>
    let
        datas, info, total_cases, total_recovered, total_deaths, total_new_cases_today, total_active_cases,
        srcEl = document.getElementById('data-source'),
        datEls = document.querySelectorAll('.card.data span'),
        load = anime.timeline({
            targets: '#loader',
            duration: 2000,
            easing: 'cubicBezier(0.150, 0.680, 0.350, 1)',
            loop: true
        }).add({
            keyframes: [
                { scaleX: 0 },
                { scaleX: 1 }
            ]
        })
    document.addEventListener('DOMContentLoaded', async () => {
        // datas = await fetch('https://thevirustracker.com/free-api?countryTimeline=ID')
        //             .then(r => r.json())
        //             .then(r => {
        //                 load.seek(load.duration)
        //                 load.pause()
        //             })
        datas = await fetch('https://thevirustracker.com/free-api?countryTotal=ID')
                    .then(r => r.json())
                    .then(r => {
                        load.seek(load.duration)
                        load.pause()
                        return ({ info, total_cases, total_recovered, total_deaths, total_new_cases_today, total_active_cases } = r.countrydata[0])
                    })
        srcEl.href = info.source
        srcEl.textContent += info.source
        // anime({
        //     targets: datEls,
        //     update: () => {
                
        //     },
        //     easing: 'linear'
        // })
        document.getElementById('cases').textContent = total_cases
        document.getElementById('active').textContent = total_active_cases
        document.getElementById('recovered').textContent = total_recovered
        document.getElementById('perday').textContent = total_new_cases_today
        document.getElementById('death').textContent = total_deaths
        document.getElementById('region').textContent = info.title
    })
</script>
</html>